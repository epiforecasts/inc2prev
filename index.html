<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Estimate incidence from Prevalence Estimates â€¢ inc2prev</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="bootstrap-toc.css">
<script src="bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="pkgdown.css" rel="stylesheet">
<script src="pkgdown.js"></script><meta property="og:title" content="Estimate incidence from Prevalence Estimates">
<meta property="og:description" content="Estimate incidence from prevalence estimates, currently
    demonstrated using the Office for National Statistics COVID-19
    prevalence estimates.">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-home">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="index.html">inc2prev</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.1.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="reference/index.html">Reference</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="contents col-md-9">

<div class="section level1">
<div class="page-header"><h1 id="estimate-epidemiological-quantities-from-repeated-cross-sectional-prevalence-measurements">Estimate epidemiological quantities from repeated cross-sectional prevalence measurements<a class="anchor" aria-label="anchor" href="#estimate-epidemiological-quantities-from-repeated-cross-sectional-prevalence-measurements"></a>
</h1></div>
<p>In this work, we use a semi-mechanistic method to estimating epidemiological quantities such as infection incidence, infection growth rates, reproduction numbers and immunological parameters from Office for National Statistics (ONS) prevalence and antibody positivity estimates at the national, and subnational levels, as well as across age groups. Our approach assumes that unobserved infections can be represented using an initial intercept and a Gaussian process with a logit link function. To estimate population prevalence we convolve the PCR detection curve estimated in <a href="https://doi.org/10.1186/s12916-021-01982-x" class="external-link">Hellewell <em>et al.</em>, <em>BMC Medicine</em>, 2021</a>, with uncertainty assumed to be normal and independent for each day since infection</p>
<p>We model antibody postitivity by fitting an initial proportion of the population that have infection derived antibodies. We then fit a daily model that assumes that some fraction of new infections that are not already antibody postive become so and that a proportion of those current antibody postive become antibody negative. We include vaccination similarly and assume that some fraction of those vaccination become antibody positive and that this positivity wanes with a daily rate (independent from the waning rate of those antibody positive from infection). This estimate of population level antibody positivity is then averaged across the time windows of the available antibody positivity estimates with again a normal observation model being assumed with the standard error made up of the ONS estimated standard error and a shared standard error term estimated in the model.</p>
<p>The model is implemented in <code>stan</code> using <code>cmdstanr</code>.</p>
</div>
<div class="section level1">
<h1 id="citation">Citation<a class="anchor" aria-label="anchor" href="#citation"></a>
</h1>
<p>Abbott, Sam, and Sebastian Funk. 2022. <em>Estimating Epidemiological Quantities from Repeated Cross-Sectional Prevalence Measurements.</em> medRxiv. <a href="https://doi.org/10.1101/2022.03.29.22273101" class="external-link uri">https://doi.org/10.1101/2022.03.29.22273101</a>.</p>
<p><strong><a href="https://doi.org/10.1101/2022.03.29.22273101" class="external-link">Preprint</a></strong></p>
<p><strong>Working paper: <a href="https://epiforecasts.io/inc2prev/paper" class="external-link">as html</a>, <a href="https://github.com/epiforecasts/inc2prev/paper.pdf" class="external-link">or pdf</a></strong></p>
</div>
<div class="section level1">
<h1 id="real-time-estimates">Real-time estimates<a class="anchor" aria-label="anchor" href="#real-time-estimates"></a>
</h1>
<p>The latest estimates are available in a <a href="https://epiforecasts.io/inc2prev/report" class="external-link">real-time report</a>.</p>
<p>The code in this repository can be used to <a href="https://github.com/epiforecasts/inc2prev/blob/master/scripts/estimate.R" class="external-link">reproduce the results</a>, and <a href="https://github.com/epiforecasts/inc2prev/blob/master/scripts/plot_estimates.R" class="external-link">create the figures</a> Estimates are also available as <a href="https://github.com/epiforecasts/inc2prev/blob/master/outputs/" class="external-link">data tables</a> (labelled estimates_{level}.csv).</p>
</div>
<div class="section level1">
<h1 id="example-estimates-from-england">Example estimates from England<a class="anchor" aria-label="anchor" href="#example-estimates-from-england"></a>
</h1>
<p>We ONS estimates for prevalence and antibody positivity in England to estimate infections and transmission parameters. The code to reproduce these results can be found <a href="https://github.com/epiforecasts/inc2prev/blob/master/scripts/simple-example.R" class="external-link">here</a></p>
<p><img src="figures/example/prev.png"></p>
<p><em>Figure 1: ONS prevalence estimates compared to model estimates of ONS prevalence combined with model estimates of population prevalence.</em></p>
<p><img src="figures/example/ab.png"></p>
<p><em>Figure 2: ONS antibody positivity estimates compared to model estimates of ONS antibody positivity combined with model estimates of population antibody positivity.</em></p>
<p><img src="figures/example/infections.png"></p>
<p><em>Figure 3: Daily infection incidence estimates</em></p>
<p><img src="figures/example/growth.png"></p>
<p><em>Figure 4: Infection growth rate estimates</em></p>
<p><img src="figures/example/Rt.png"></p>
<p><em>Figure 5: Effective reproduction rate rate estimates</em></p>
<div class="section level2">
<h2 id="fit-diagnostics">Fit diagnostics<a class="anchor" aria-label="anchor" href="#fit-diagnostics"></a>
</h2>
<p><img src="figures/example/pairs.png"></p>
<p><em>Figure 6: Pairs plot of a sample of parameter posteriors</em></p>
</div>
</div>
<div class="section level1">
<h1 id="documentation">Documentation<a class="anchor" aria-label="anchor" href="#documentation"></a>
</h1>
<div class="section level2">
<h2 id="file-structure">File structure<a class="anchor" aria-label="anchor" href="#file-structure"></a>
</h2>
<table class="table">
<colgroup>
<col width="50%">
<col width="50%">
</colgroup>
<thead><tr class="header">
<th>Folder</th>
<th>Purpose</th>
</tr></thead>
<tbody>
<tr class="odd">
<td><a href="data-raw/"><code>data-raw</code></a></td>
<td>Raw data and scripts to generate processed data.</td>
</tr>
<tr class="even">
<td><a href="data-processed/"><code>data-processed</code></a></td>
<td>Data processed ready for use in downstream analyses.</td>
</tr>
<tr class="odd">
<td><a href="R/"><code>R</code></a></td>
<td>R functions for preprocessing data, model fitting, and model postprocessing.</td>
</tr>
<tr class="even">
<td><a href="scripts/"><code>scripts</code></a></td>
<td>Scripts used to estimate models and analyse result.</td>
</tr>
<tr class="odd">
<td><a href="stan/"><code>stan</code></a></td>
<td>The backend stan model code and support functions.</td>
</tr>
<tr class="even">
<td><a href=".devcontainer/"><code>.devcontainer</code></a></td>
<td>Contains the projects <code>Dockerfile</code> and setup instructions for using the code with <code>vscode</code>.</td>
</tr>
</tbody>
</table>
</div>
<div class="section level2">
<h2 id="obtaining-data">Obtaining data<a class="anchor" aria-label="anchor" href="#obtaining-data"></a>
</h2>
<p>The data used in this repository can be obtained using the scripts in <code>data-raw/</code>. In particular, PCR positivity data by nation, region, age and variant can be downloaded using</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode sh"><code class="sourceCode bash"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="ex">Rscript</span> data-raw/update-cis.R</span></code></pre></div>
<p>and antibody data can be downloaded using</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode sh"><code class="sourceCode bash"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="ex">Rscript</span> data-raw/update-ab.R</span></code></pre></div>
</div>
<div class="section level2">
<h2 id="reproducing-the-estimates">Reproducing the estimates<a class="anchor" aria-label="anchor" href="#reproducing-the-estimates"></a>
</h2>
<p>Estimates provided here can be generated using the <code>scripts/estimate.R</code> script. Before running this, the <code>inc2prev</code> package contained in this repository needs to be installed, e.g.Â using</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">remotes</span><span class="fu">::</span><span class="fu"><a href="https://remotes.r-lib.org/reference/install_github.html" class="external-link">install_github</a></span><span class="op">(</span><span class="st">"epiforecasts/inc2prev"</span><span class="op">)</span></span></code></pre></div>
<p>The estimates shown in the plots above were generated using</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode sh"><code class="sourceCode bash"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="ex">Rscript</span> scripts/estimate.R <span class="at">-d</span> 1</span></code></pre></div>
</div>
<div class="section level2">
<h2 id="dependencies">Dependencies<a class="anchor" aria-label="anchor" href="#dependencies"></a>
</h2>
<p>All dependencies can be installed using the following,</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">remotes</span><span class="fu">::</span><span class="fu">install_dev_deps</span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p>Alternatively a docker <a href="https://github.com/epiforecasts/inc2prev/blob/main/.devcontainer/Dockerfile" class="external-link">container</a> and <a href="https://github.com/epiforecasts/inc2prev/pkgs/container/inc2prev" class="external-link">image</a> is provided. An easy way to make use of this is using the Remote development extension of <code>vscode</code>.</p>
</div>
<div class="section level2">
<h2 id="installing-cmdstan">Installing CmdStan<a class="anchor" aria-label="anchor" href="#installing-cmdstan"></a>
</h2>
<p>If you donâ€™t already have CmdStan installed then it is also necessary to install CmdStan usin CmdStanRâ€™s <code>install_cmdstan()</code> function to enable model fitting. A suitable C++ toolchain is also required. Instructions are provided in the <a href="https://mc-stan.org/cmdstanr/articles/cmdstanr.html" class="external-link"><em>Getting started with CmdStanR</em></a> vignette. See the <a href="https://mc-stan.org/cmdstanr/" class="external-link">CmdStanR documentation</a> for further details and support.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">cmdstanr</span><span class="fu">::</span><span class="fu"><a href="https://mc-stan.org/cmdstanr/reference/install_cmdstan.html" class="external-link">install_cmdstan</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
</div>
</div>
<div class="section level1">
<h1 id="license">License<a class="anchor" aria-label="anchor" href="#license"></a>
</h1>
<p>This project uses data from the Office for National Statistics Community Infection Survey, which is licensed under the <a href="https://www.ons.gov.uk/peoplepopulationandcommunity/healthandsocialcare/conditionsanddiseases/datasets/coronaviruscovid19infectionsurveydata" class="external-link">Open Government License v3.0</a>.</p>
</div>

  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <div class="license">
<h2 data-toc-skip>License</h2>
<ul class="list-unstyled">
<li>
<a href="https://opensource.org/licenses/BSD-3-Clause" class="external-link">BSD</a> 3-Clause + file <a href="LICENSE-text.html">LICENSE</a>
</li>
</ul>
</div>


<div class="citation">
<h2 data-toc-skip>Citation</h2>
<ul class="list-unstyled">
<li><a href="authors.html#citation">Citing inc2prev</a></li>
</ul>
</div>

<div class="developers">
<h2 data-toc-skip>Developers</h2>
<ul class="list-unstyled">
<li>Sam Abbott <br><small class="roles"> Author, maintainer </small> <a href="https://orcid.org/0000-0001-8057-8037" target="orcid.widget" aria-label="ORCID" class="external-link"><span class="fab fa-orcid orcid" aria-hidden="true"></span></a> </li>
<li>Sebastian Funk <br><small class="roles"> Author </small> <a href="https://orcid.org/0000-0002-2842-3406" target="orcid.widget" aria-label="ORCID" class="external-link"><span class="fab fa-orcid orcid" aria-hidden="true"></span></a> </li>
</ul>
</div>



  </div>
</div>


      <footer><div class="copyright">
  <p></p>
<p>Developed by Sam Abbott, Sebastian Funk.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
